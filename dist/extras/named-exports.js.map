{"version":3,"file":"named-exports.js","sources":["../../src/extras/named-exports.js"],"sourcesContent":["/*\n * Named exports support for legacy module formats in SystemJS 2.0\n */\nconst systemPrototype = System.constructor.prototype;\n\n// hook System.register to know the last declaration binding\nlet lastRegisterDeclare;\nconst systemRegister = systemPrototype.register;\nsystemPrototype.register = function (deps, declare) {\n  lastRegisterDeclare = declare;\n  systemRegister.call(this, deps, declare);\n};\n\nconst getRegister = systemPrototype.getRegister;\nsystemPrototype.getRegister = function () {\n  const register = getRegister.call(this);\n  // if it is an actual System.register call, then its ESM\n  // -> dont add named exports\n  if (!register || register[1] === lastRegisterDeclare || register[1].length === 0)\n    return register;\n\n  // otherwise it was provided by a custom instantiator\n  // -> extend the registration with named exports support\n  const registerDeclare = register[1];\n  register[1] = function (_export, _context) {\n    // hook the _export function to note the default export\n    let defaultExport;\n    const declaration = registerDeclare.call(this, function (name, value) {\n      if (name === 'default')\n        defaultExport = value;\n      _export(name, value);\n    }, _context);\n    // hook the execute function\n    const execute = declaration.execute;\n    if (execute)\n      declaration.execute = function () {\n        execute.call(this);\n        // do a bulk export of the default export object\n        // to export all its names as named exports\n        if (typeof defaultExport === 'object')\n          _export(defaultExport);\n      };\n    return declaration;\n  };\n  return register;\n};\n"],"names":["systemPrototype","System","constructor","prototype","lastRegisterDeclare","systemRegister","register","deps","declare","call","getRegister","length","registerDeclare","_export","_context","defaultExport","declaration","name","value","execute"],"mappings":";EAAA;;;EAGA,MAAMA,eAAe,GAAGC,MAAM,CAACC,WAAP,CAAmBC,SAA3C;;EAGA,IAAIC,mBAAJ;EACA,MAAMC,cAAc,GAAGL,eAAe,CAACM,QAAvC;;EACAN,eAAe,CAACM,QAAhB,GAA2B,UAAUC,IAAV,EAAgBC,OAAhB,EAAyB;EAClDJ,EAAAA,mBAAmB,GAAGI,OAAtB;EACAH,EAAAA,cAAc,CAACI,IAAf,CAAoB,IAApB,EAA0BF,IAA1B,EAAgCC,OAAhC;EACD,CAHD;;EAKA,MAAME,WAAW,GAAGV,eAAe,CAACU,WAApC;;EACAV,eAAe,CAACU,WAAhB,GAA8B,YAAY;EACxC,QAAMJ,QAAQ,GAAGI,WAAW,CAACD,IAAZ,CAAiB,IAAjB,CAAjB,CADwC;EAGxC;;EACA,MAAI,CAACH,QAAD,IAAaA,QAAQ,CAAC,CAAD,CAAR,KAAgBF,mBAA7B,IAAoDE,QAAQ,CAAC,CAAD,CAAR,CAAYK,MAAZ,KAAuB,CAA/E,EACE,OAAOL,QAAP,CALsC;EAQxC;;EACA,QAAMM,eAAe,GAAGN,QAAQ,CAAC,CAAD,CAAhC;;EACAA,EAAAA,QAAQ,CAAC,CAAD,CAAR,GAAc,UAAUO,OAAV,EAAmBC,QAAnB,EAA6B;EACzC;EACA,QAAIC,aAAJ;EACA,UAAMC,WAAW,GAAGJ,eAAe,CAACH,IAAhB,CAAqB,IAArB,EAA2B,UAAUQ,IAAV,EAAgBC,KAAhB,EAAuB;EACpE,UAAID,IAAI,KAAK,SAAb,EACEF,aAAa,GAAGG,KAAhB;;EACFL,MAAAA,OAAO,CAACI,IAAD,EAAOC,KAAP,CAAP;EACD,KAJmB,EAIjBJ,QAJiB,CAApB,CAHyC;;EASzC,UAAMK,OAAO,GAAGH,WAAW,CAACG,OAA5B;EACA,QAAIA,OAAJ,EACEH,WAAW,CAACG,OAAZ,GAAsB,YAAY;EAChCA,MAAAA,OAAO,CAACV,IAAR,CAAa,IAAb,EADgC;EAGhC;;EACA,UAAI,OAAOM,aAAP,KAAyB,QAA7B,EACEF,OAAO,CAACE,aAAD,CAAP;EACH,KAND;EAOF,WAAOC,WAAP;EACD,GAnBD;;EAoBA,SAAOV,QAAP;EACD,CA/BD;;;;"}